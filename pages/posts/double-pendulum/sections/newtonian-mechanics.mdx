import FreeBodyViewer from "../demos/free-body-viewer.js";
import FreeBodyEquations from './newtonian-mechanics/free-body-equations.mdx';
import CartesianNewtonianEquation1 from './newtonian-mechanics/cartesian-newtonian-equation-1.mdx';
import CartesianNewtonianEquation2 from './newtonian-mechanics/cartesian-newtonian-equation-2.mdx';
import CartesianNewtonianEquations from './newtonian-mechanics/cartesian-newtonian-equations.mdx';
import GeneralizedDdaDdb1 from './newtonian-mechanics/generalized-equation-dda-ddb-1.mdx';
import GeneralizedDdaDdb2 from './newtonian-mechanics/generalized-equation-dda-ddb-2.mdx';
import GeneralizedDdb from './newtonian-mechanics/generalized-ddb.mdx';
import GeneralizedDda from './newtonian-mechanics/generalized-dda.mdx';
import GeneralizedFinal from './newtonian-mechanics/generalized-final.mdx';

<!-- ## What does it mean to _simulate_ a system? -->

## Deriving the Equations of Motion using Newtonian Mechanics

<!-- ## newtonian mechanics -->

<!-- > _Let's derive the equations of motion for the double pendulum using newton's laws of motion._ -->

<!-- The newtonian approach to deriving the dynamic equations of motion of a system
relies on the forces acting on the bodies within the system. In practice, this
means determining the forces using a free body diagram, then using the
kinematic description of the system coupled with
newton's second law, $F=ma$ to derive a set of equations that determine the
system's motion as a function of time. -->

Point mass $a$ is being acted on by the tension forces from the massless rods
connecting it to the origin and $b$. Point mass $b$ is being acted on by
the tension from the massless rods connecting it to $a$, $T_b$. Both point masses
are being acted on by gravity. This is illustrated as a free body diagram
below (gravity omitted).

<!-- First, let's draw free body diagrams for the point masses, $a$ and $b$. (Note: the
diagram is missing gravity currently.) -->

<FreeBodyViewer/>

<!-- As depicted in the diagram above, point mass $a$ is being acted on by the
tension from the massless rods connect it to the origin and $b$. -->

<!-- Now that we have a system of equations that describe the acceleration of the
system for a given state given the forces acting on the bodies in the system.
Next, we can combine the -->

Using newton's second law (i.e. $F = ma$) and the free body diagram, we can form a
system of equations that describes how the motion of the point masses relate to the
forces being applied to them. $\sin\theta_x$ and $\cos\theta_x$ are denoted as $s_x$
and $c_x$ for convenience.

<FreeBodyEquations/>

Since the tension forces ($T_a$ and $T_b$) are only acting on bodies within the system,
they can be eliminated by algebraic manipulation.


<!--
After some heavy algebra (see appendix for details), we can solve for
$\ddot{\theta}$ using the equations for acceleration along with thosederived
from newton's second law. The final solution is:

$$
\begin{alignedat}{1}
0 &= 2(m_a + m_bs_{a-b}^2)l_a\ddot{\theta_a}
 +2m_bs_{a-b}c_{a-b}l_a\dot{\theta_a}^2
 +2m_bs_{a-b}l_b\dot{\theta_b}^2
 -((2m_a + m_b)s_a +m_bs_{a-2b})g\\
0 &= (m_a+m_bs_{a-b}^2)l_b\ddot{\theta_b}
  -(m_a + m_b)s_{a-b}l_a\dot{\theta_a}^2
  -m_bs_{a-b}c_{a-b}l_b\dot{\theta_b}^2
  -(m_a + m_b)s_{a-b}c_ag
\end{alignedat}
$$

-->

<!-- Starting from the kinematic equations for acceleration and the equations derived
from newton's second law, this section will describe how to solve for the
generlized accelerations, $\ddot{\theta}$. -->

<!-- We'll start by manipulating the second law equations to eliminate the
internal forces: -->

1. Solve for $T_b$ using $\text{(3)}$, then use substitution of $T_b$
   into $\text{(4)}$ to get a new equation of motion that does not
   depend on the tension forces.

  <CartesianNewtonianEquation1/>


2. Solve for $T_a$ using $\text{(1)}$ and $T_b$ from the last step, then substitute
  $T_a$ and $T_b$ into $\text{(2)}$ to get a second new equation of motion that
  does not depend on the tension forces.

  <CartesianNewtonianEquation2/>

Now we have the following equations of motions that do not depend on the tension forces.

<CartesianNewtonianEquations/>

Note that $\text{(5)}$ and $\text{(6)}$ are still not expressed entirely in terms of the
variables we chose to represent the state of the system, $\theta_a$ and $\theta_b$ as
they still depend on the cartesian accelerations. We can derive and apply the forward kinematic
equations relating the generalized and cartesian accelerations, then use them to get
equations of motion that are truly in terms of $\theta_a$, $\theta_b$, and their
derivatives.

The cartesian positions of the point masses can be derived using geometry by
inspection.

$$
\begin{alignedat}{4}
x_a =& &s_al_a& \qquad &\text{(7)}\\
y_a =& -&c_al_a& \qquad &\text{(8)}  \\
x_b =& &s_al_a& + s_bl_b \qquad &\text{(9)} \\
y_b =& -&c_al_a& -c_bl_b \qquad &\text{(10)}
\end{alignedat}
$$

Taking the derivative of the positions with respect to time, we get the velocities.

$$
\begin{alignedat}{5}
\dot{x_a} &= &c_al_a\dot{\theta_a}& \qquad &\text{(11)}\\
\dot{y_a} &= &s_al_a\dot{\theta_a}& \qquad &\text{(12)}\\
\dot{x_b} &= &c_al_a\dot{\theta_a}& + c_bl_b\dot{\theta_b} \qquad &\text{(13)}\\
\dot{y_b} &= &s_al_a\dot{\theta_a}& + s_bl_b\dot{\theta_b} \qquad &\text{(14)}
\end{alignedat}
$$

Taking the derivatives once more with respet to time, we get the accelerations:

$$
\begin{alignedat}{3}
\ddot{x_a} &= c_al_a\ddot{\theta_a} - s_al_a\dot{\theta_a}^2 \qquad &\text{(15)}\\
\ddot{y_a} &= s_al_a\ddot{\theta_a} + c_al_a\dot{\theta_a}^2 \qquad &\text{(16)}\\
\ddot{x_b} &= c_al_a\ddot{\theta_a} + c_bl_b\ddot{\theta_b} - s_al_a\dot{\theta_a}^2 - s_bl_b\dot{\theta_b}^2 \qquad &\text{(17)}\\
\ddot{y_b} &= s_al_a\ddot{\theta_a} + s_bl_b\ddot{\theta_b} + c_al_a\dot{\theta_a}^2 + c_bl_b\dot{\theta_b}^2 \qquad &\text{(18)}
\end{alignedat}
$$

Now we are ready to manipulate the equations of motion into their final form, which
only depends on the generalized coordinates, $\theta_a$ and $\theta_b$.


<!-- ## Deriving the Equations of Motion using Newtonian Mechanics (Part 2) -->

<!-- Note that the equations still depend on the cartesian accelerations of the point
masses. Next, we will use the kinematic equations for acceleration to solve
these equations for the generalized accelerations $\ddot{\theta}$. To make this easier, let
$s_x=s_x$ and $c_x=c_x$.

We have gotten rid of the external forces, but the equation not yet completely
in terms of the generalized coordiantes $\theta$. We still need to substitute in
the cartesian accelerations of the point masses using the kinematic equations.
After the substitution, we can rearrange, to arrive a the following equations of
motion: -->

<!-- Solving for that thing: -->

1. Substitute $\text{(17)}$ and $\text{(18)}$ into $\text{(5)}$ to the the first equation of motion
   in terms of the generalized parameters.

  <GeneralizedDdaDdb1/>

2. Substitute  $\text{(15)}$, $\text{(16)}$, $\text{(17)}$ and $\text{(18)}$ into $\text{(6)}$ to
   the the first equation of motion in terms of the generalized parameters.

  <GeneralizedDdaDdb2/>

Now we have two equations of motion in terms of the generalized parameters, but both equations
depend on $\ddot{\theta_a}$ and $\ddot{\theta_b}$. What we really want is one equation for
$\ddot{\theta_a}$ and one for $\ddot{\theta_b}$, which we can achieve through some algebraic
manipulation.

1. Eliminate $\ddot{\theta_a}$ from $\text{(19)}$ using $\text{(20)}$ to solve for $\ddot{\theta_b}$.

  <GeneralizedDdb/>

2. Eliminate $\ddot{\theta_b}$ from $\text{(19)}$ using $\text{(21)}$ to solve for $\ddot{\theta_a}$.

  <GeneralizedDda/>

And we finally have the equations of motion for our model that will be amenable to simulation
as we'll see in the coming sections.

<GeneralizedFinal/>

