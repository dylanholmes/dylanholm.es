<!DOCTYPE html><html lang="en"><head><meta charSet="UTF-8"/><title>Abstracting Physics in Unity - dylanholm.es</title><meta name="description" content="A blog."/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="alternate" title="RSS Feed" type="application/json" href="http://dylanholm.es/feed.json"/><meta property="og:url" content="http://dylanholm.es"/><meta property="og:title" content="Abstracting Physics in Unity"/><meta property="og:description" content="A blog."/><meta property="og:image" content="http://dylanholm.es/static/site-feature.png"/><meta property="og:image:width" content="1200"/><meta property="og:image:height" content="630"/><meta name="next-head-count" content="11"/><link rel="preload" href="/_next/static/css/3657d00d802690a30548.css" as="style"/><link rel="stylesheet" href="/_next/static/css/3657d00d802690a30548.css"/><link rel="preload" href="/_next/static/_DO1bjMeCSiBo1RIPANSP/pages/_app.js" as="script"/><link rel="preload" href="/_next/static/_DO1bjMeCSiBo1RIPANSP/pages/posts/abstracting-physics-in-unity.js" as="script"/><link rel="preload" href="/_next/static/runtime/webpack-c212667a5f965e81e004.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.e84fa698c7ee940652bd.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.37a93964079306a533b5.js" as="script"/><link rel="preload" href="/_next/static/runtime/main-c81efbd6f0ef40ffb59e.js" as="script"/><link rel="preload" href="/_next/static/chunks/803532223802cc185471f671d12da71ae1d417c5.645f028cd19bfa4528fa.js" as="script"/><link rel="preload" href="/_next/static/chunks/23c0d7ae758c1fc155c78ade0ea477b0c168e0df.6da95341e60df5c79f7d.js" as="script"/><style id="__jsx-4179129003">h1.jsx-4179129003{margin:0;margin-bottom:0;font-size:1em;line-height:1.5;}p.jsx-4179129003{margin:0;font-size:1em;line-height:1.5;}</style><style id="__jsx-3928104162">nav.jsx-3928104162{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}a.jsx-3928104162:not(:last-child){margin-right:1em;}</style><style id="__jsx-1260337168">header.jsx-2207507930{padding:1em 0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;}</style><style id="__jsx-3632116931">@font-face{font-family:'Montserrat';src:url(/static/fonts/Montserrat/Montserrat-ExtraLight.ttf) format('truetype');font-weight:200;font-style:normal;}@font-face{font-family:'Montserrat';src:url(/static/fonts/Montserrat/Montserrat-Light.ttf) format('truetype');font-weight:300;font-style:normal;}html{margin:0;box-sizing:border-box;}*,*:before,*:after{box-sizing:inherit;}body{margin:0;font-size:18px;font-family:'Montserrat',sans-serif;font-weight:300;color:#333;line-height:1.5;background-color:#fff;}h1,h2,h3,h4{margin-bottom:0.5rem;font-weight:300;color:inherit;line-height:1.25;}h1{font-size:2rem;}h2{margin-top:1rem;font-size:1.8rem;}h3{margin-top:1.5rem;font-size:1.5rem;}p{margin-top:0;margin-bottom:1rem;}ul,ol,dl{margin-top:0;margin-bottom:1rem;}a{color:#33e;cursor:pointer;}a:hover,a:focus{-webkit-text-decoration:underline;text-decoration:underline;}hr{position:relative;margin:1.5em 0;border:0;border-top:1px solid #eee;border-bottom:1px solid #fff;}blockquote{padding:0.5em 1em;margin:0.8em 0;color:#555;border-left:0.25em solid #ccc;}blockquote p:last-child{margin-bottom:0;}pre code{font-size:18px;}code{color:#fff;}.wrap{max-width:38rem;margin-left:auto;margin-right:auto;}article img{max-width:100%;height:auto;}.katex{font-size:1.05em;}.katex-display{font-size:1em;}.katex-display{text-align:left;padding-left:1em;}.katex-display>.katex{text-align:left;}</style><style id="__jsx-3237423915">a.jsx-3237423915{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column; ;}</style><style id="__jsx-1238384267">header.jsx-1238384267{margin-bottom:2em;}[rel='author'].jsx-1238384267{margin-left:1em;}article.jsx-1238384267{margin-bottom:2em;}footer.jsx-1238384267{margin-top:2em;}.post-pagination.jsx-1238384267{display:grid;grid-template-columns:1fr 1fr;}</style><style id="__jsx-3055961061">footer.jsx-3055961061{padding:1em 0;}p.jsx-3055961061{margin-top:2em;}</style><style id="__jsx-3779335083">.jsx-3779335083{max-width:45rem;margin:0 auto;padding:0 1em;}</style></head><body><div id="__next"><div class="jsx-3779335083"><header class="jsx-2207507930"><p class="jsx-4179129003"><a rel="me" class="jsx-4179129003" href="/">dylanholm.es</a></p><nav class="jsx-3928104162"><a class="jsx-3928104162" href="/about">/about</a></nav></header><main><article class="jsx-1238384267 h-entry"><header class="jsx-1238384267"><h1 class="jsx-1238384267 p-name">/posts/abstracting-physics-in-unity</h1></header><div class="jsx-1238384267 e-content"><h2>Problem</h2><p>Unity currently comes with two possible physic engine integrations; the default
PhysX integration and new preview-only Havok integration. Its great to see more
choices coming out of the box, but the integrations are not seamless. The PhysX
integration requires a Monobehaviour-centric workflow, while Havok requires
switching over to the new ECS workflow. This couples the choice of physics
integration to the project workflow early on as switching later may require you
to essentially re-write your whole project.</p><p>The standard software engineering practice to decouple components in situations
like this is to use a combination of abstraction and inversion of control. In
this post we&#x27;ll look at how we can apply these concepts to abstracting the physics
in Unity in a way that will allow us to easily swap out our physics integration,
whether that be between PhysX, Havok, or some custom physics integration. We&#x27;ll
also consider the design choices that go into selecting an appropriate abstraction
(nothing&#x27;s free).</p><h2>Designing the Abstraction Layer</h2><p>Designing an abstraction layer boils down to deciding on a common interface that
can support all the implemenations you plan on supporting. In our case, the
implementations (the physics integrations) are already existing and can be
expected to differ in a non trivial way, for example they may have differing
settings, or some features may only be available in one or the other. There are
two common approaches to desiging an interface between existing implenations, the
choice of which depends on the project goals.</p><p>The first choice is to limit the interface to only functionality that is supported
by all of the implementations. This functionality is the intersection of the
functionality supported by all implemenations.</p><p>The second choice is to expand the interface to all functionality that is supported
by any of the implemenations. This functionality is the union of the
functionality supported by all implemenations.</p><p>While these choices sound pretty black and white, they are not.</p><h2></h2><p>Let&#x27;s get started with unity.</p><pre><pre class="prism-code language-bash" style="color:#393A34;background-color:#f6f8fa;padding:20px"><div class="token-line" style="color:#393A34"><span class="token plain">$ ./some-shell-script.sh</span></div><div class="token-line" style="color:#393A34"><span class="token plain">$ b.</span></div><div class="token-line" style="color:#393A34"><span class="token plain">$ sss.sh</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span></div></pre></pre><pre><pre class="prism-code language-cs" style="color:#393A34;background-color:#f6f8fa;padding:20px"><div class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">Main</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token return-type class-name keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">String</span><span class="token class-name punctuation" style="color:#393A34">[</span><span class="token class-name punctuation" style="color:#393A34">]</span><span class="token plain"> args</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">println</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Ahoy!&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span></div></pre></pre><pre><pre class="prism-code language-java" style="color:#393A34;background-color:#f6f8fa;padding:20px"><div class="token-line" style="color:#393A34"><span class="token plain">public class Main {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  public static void main(String[] args) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    System.out.println(&quot;Ahoy!&quot;);</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  }</span></div><div class="token-line" style="color:#393A34"><span class="token plain">}</span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span></div></pre></pre></div><footer class="jsx-1238384267"><div class="jsx-1238384267 post-pagination"><a class="jsx-3237423915" href="/posts/algorithm-recursive-newton-euler"><small class="jsx-3237423915">Read <!-- -->previous<!-- --> post </small>recursive newton euler algorithm</a></div></footer></article></main><footer class="jsx-3055961061"></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/posts/abstracting-physics-in-unity","query":{},"buildId":"_DO1bjMeCSiBo1RIPANSP","nextExport":true,"autoExport":true,"isFallback":false}</script><script nomodule="" src="/_next/static/runtime/polyfills-02135cf34393326fb5b0.js"></script><script async="" data-next-page="/_app" src="/_next/static/_DO1bjMeCSiBo1RIPANSP/pages/_app.js"></script><script async="" data-next-page="/posts/abstracting-physics-in-unity" src="/_next/static/_DO1bjMeCSiBo1RIPANSP/pages/posts/abstracting-physics-in-unity.js"></script><script src="/_next/static/runtime/webpack-c212667a5f965e81e004.js" async=""></script><script src="/_next/static/chunks/framework.e84fa698c7ee940652bd.js" async=""></script><script src="/_next/static/chunks/commons.37a93964079306a533b5.js" async=""></script><script src="/_next/static/runtime/main-c81efbd6f0ef40ffb59e.js" async=""></script><script src="/_next/static/chunks/803532223802cc185471f671d12da71ae1d417c5.645f028cd19bfa4528fa.js" async=""></script><script src="/_next/static/chunks/23c0d7ae758c1fc155c78ade0ea477b0c168e0df.6da95341e60df5c79f7d.js" async=""></script><script src="/_next/static/_DO1bjMeCSiBo1RIPANSP/_buildManifest.js" async=""></script><script src="/_next/static/_DO1bjMeCSiBo1RIPANSP/_ssgManifest.js" async=""></script></body></html>